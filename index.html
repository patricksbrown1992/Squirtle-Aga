<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Squirtle-Aga</title>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        canvas {
            background: #eee;
            display: block;
            margin: 0 auto;
        }
    </style>
    <script src="js/SquirtleBullet.js"></script>
</head>

<body>

    <canvas id="myCanvas" width="320" height="480"></canvas>

    <script>
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        var squirtleWidth = 24;
        var squirtleHeight = 31;
        var squirtleX = (canvas.width - squirtleWidth) / 2;
        var dragoniteHeight = 31;
        var dragoniteWidth = 24;
        var dragonitePadding = 15;
        var dragoniteRowCount = 1;
        var dragoniteColumnCount = 4;
        var butterfreeWidth = 21;
        var butterfreeHeight = 17;
        var butterfreePadding = 5;
        var butterfreeRowCount = 2;
        var butterfreeColumnCount = 8;
        var butterfreeOffsetTop = 30;
        var butterfreeOffsetLeft = 60;
        var beedrillOffsetLeft = 60;
        var beedrillOffsetTop = 100
        var beedrillHeight = 22;
        var beedrillWidth = 20;
        var beedrillPadding = 5;
        var beedrillRowCount = 2;
        var beedrillColumnCount = 8;
        var score = 0;
        var lives = 3;
        var rightPressed = false;
        var leftPressed = false;
        var spacePressed = false;
        var bullets = [];


        var butterfrees = [];
        for (var c = 0; c < butterfreeColumnCount; c++) {
            butterfrees[c] = [];
            for (var r = 0; r < butterfreeRowCount; r++) {
                butterfrees[c][r] = { x: 0, y: 0 };
            }
        }

        var beedrills = [];
        for (var c = 0; c < beedrillColumnCount; c++) {
            beedrills[c] = [];
            for (var r = 0; r < beedrillRowCount; r++) {
                beedrills[c][r] = { x: 0, y: 0 };
            }
        }

        


        // var dragonites = [];
        // for (var c = 0; c < dragoniteColumnCount; c++) {
        //     dragonites[c] = [];
        //     for (var r = 0; r < dragoniteRowCount; r++) {
        //         dragonites[c][r] = { x: 0, y: 0 }
        //     }
        // }

        // var beedrills = [];
        // for (var c = 0; c < beedrillColumnCount; c++) {
        //     beedrills[c] = [];
        //     for (var r = 0; r < beedrillRowCount; r++) {
        //         beedrills[c][r] = { x: 0, y: 0 }
        //     }
        // }
        
       
        function addBullet(){
            // debugger
            var bullet = new SquirtleBullet(squirtleX, 480)
            bullets.push(bullet);
        }

        

        document.addEventListener("keydown", keyDownHandler, false);
        document.addEventListener("keyup", keyUpHandler, false);

        function keyDownHandler(e) {
            // debugger
            if (e.key == "Right" || e.key == "ArrowRight") {
                rightPressed = true;
            }
            else if (e.key == "Left" || e.key == "ArrowLeft") {
                leftPressed = true;
            }
            else if (e.key =' '){
                debugger
                spacePressed = true;
            }
        }

        function keyUpHandler(e) {
            if (e.key == "Right" || e.key == "ArrowRight") {
                rightPressed = false;
            }
            else if (e.key == "Left" || e.key == "ArrowLeft") {
                leftPressed = false;
            }
            else if (e.key = ' ') {
                // debugger
                spacePressed = false;
            }
        }

        function shoot(){
            if(spacePressed){
                addBullet();
            }
        }

        function drawButterfrees() {
            for (var c = 0; c < butterfreeColumnCount; c++) {
                for (var r = 0; r < beedrillRowCount; r++) {
                var butterfreeX = (c * (butterfreeWidth + butterfreePadding)) + butterfreeOffsetLeft;
                var butterfreeY = (r * (butterfreeHeight + butterfreePadding)) + butterfreeOffsetTop;
                butterfrees[c][r].x = butterfreeX;
                butterfrees[c][r].y = butterfreeY;
                ctx.beginPath();
                ctx.rect(butterfreeX, butterfreeY, butterfreeWidth, butterfreeHeight);
                ctx.fillStyle = "#0095DD";
                ctx.fill();
                ctx.closePath();
                }
            }
        }

        function drawBeedrills() {
            for (var c = 0; c < butterfreeColumnCount; c++) {
                for (var r = 0; r < butterfreeRowCount; r++) {
                    var beedrillX = (c * (beedrillWidth + beedrillPadding)) + beedrillOffsetLeft;
                    var beedrillY = (r * (beedrillHeight + beedrillPadding)) + beedrillOffsetTop;
                    beedrills[c][r].x = beedrillX;
                    beedrills[c][r].y = beedrillY;
                    ctx.beginPath();
                    ctx.rect(beedrillX, beedrillY, beedrillWidth, beedrillHeight);
                    ctx.fillStyle = "green";
                    ctx.fill();
                    ctx.closePath();
                }
            }
        }

        function drawSquirtle(){
            ctx.beginPath();
            ctx.rect(squirtleX, canvas.height - squirtleHeight, squirtleWidth, squirtleHeight);
                
            ctx.fillStyle = "#0095DD";
            ctx.fill();
            ctx.closePath()
        }

        function draw(){
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawSquirtle()
            drawButterfrees()
            drawBeedrills()

            if(rightPressed && squirtleX < canvas.width-squirtleWidth){
                squirtleX += 5;
            } 
            else if(leftPressed && squirtleX > 0){
                squirtleX -= 5;
            } 
            else if (spacePressed){
                // squirtleX -= 5;
            }
        }
        setInterval(draw, 10);
        setInterval(shoot, 25)
        
    </script>

</body>

</html>